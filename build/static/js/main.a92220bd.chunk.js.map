{"version":3,"sources":["lib/BridgeManager.js","lib/theme.js","lib/Alert.js","lib/utils.js","LocalEditor.jsx","App.jsx","index.jsx"],"names":["BridgeManager","this","instance","constructor","updateObservers","initiateBridge","addUpdateObserver","callback","observer","push","notifyObserversOfUpdate","getNote","note","componentRelay","ComponentRelay","targetWindow","window","options","coallesedSavingDelay","onReady","document","documentElement","classList","add","platform","streamContextItem","save","saveItemWithPresave","content","text","preview_plain","preview_html","light","fontFamily","fontFamilyMono","fontWeight","zIndex","link","placeholder","textSecondary","textLight","textHighlight","selected","codeComment","codePunctuation","codeNumber","codeProperty","codeTag","codeString","codeSelector","codeAttr","codeEntity","codeKeyword","codeFunction","codeStatement","codePlaceholder","codeInserted","codeImportant","blockToolbarBackground","blockToolbarTrigger","blockToolbarTriggerIcon","blockToolbarItem","blockToolbarText","blockToolbarHoverBackground","blockToolbarDivider","noticeInfoBackground","noticeInfoText","noticeTipBackground","noticeTipText","noticeWarningBackground","noticeWarningText","background","code","cursor","divider","toolbarBackground","toolbarInput","toolbarItem","tableDivider","tableSelected","tableSelectedBackground","quote","codeBackground","codeBorder","horizontalRule","imageErrorBackground","Alert","title","buttons","buttonsString","map","buttonDesc","index","url","style","genButton","join","templateString","buttonsTemplate","panelStyle","dismiss","onElement","removeChild","element","removeEventListener","keyupListener","primaryButton","primary","find","button","length","event","key","action","present","body","createElement","className","innerHTML","trim","addEventListener","forEach","querySelector","onclick","appendChild","navigator","userAgent","toLowerCase","indexOf","test","openLinkDesktop","invisibleA","display","href","target","click","remove","openLinkMobile","open","LocalEditor","React","Component","props","super","onChange","debounce","value","state","setState","get","componentDidMount","refresh","uuid","updateMarkdown","markdown","inputText","replace","m","p","q","render","autoFocus","bind","theme","uploadImage","async","file","Promise","resolve","Resizer","imageFileResizer","uri","resizeFile","onClickLink","preventDefault","ctrlKey","metaKey","_reactName","onHoverLink","embeds","App","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.a92220bd.chunk.js","sourcesContent":["import ComponentRelay from '@standardnotes/component-relay'\n\nexport default class BridgeManager {\n    /* Singleton */\n    static instance = null\n    static get () {\n      if (this.instance == null) { this.instance = new BridgeManager() }\n      return this.instance\n    }\n\n    constructor () {\n      this.updateObservers = []\n      this.initiateBridge()\n    }\n\n    addUpdateObserver (callback) {\n      const observer = { callback: callback }\n      this.updateObservers.push(observer)\n      return observer\n    }\n\n    notifyObserversOfUpdate () {\n      for (const observer of this.updateObservers) {\n        observer.callback()\n      }\n    }\n\n    getNote () {\n      return this.note\n    }\n\n    initiateBridge () {\n      this.componentRelay = new ComponentRelay({\n        targetWindow: window,\n        options: {\n          coallesedSavingDelay: 200\n        },\n        onReady: () => {\n          // On ready and permissions authorization\n          document.documentElement.classList.add(this.componentRelay.platform)\n        }\n      })\n\n      this.componentRelay.streamContextItem((note) => {\n        this.note = note\n\n        this.notifyObserversOfUpdate()\n      })\n    }\n\n    save () {\n      if (this.note) {\n        const note = this.note\n\n        // if (note.content && note.content.text) {\n        //     note.content.text = note.content.text.replace(/\\n\\\\/g, '\\n');\n        // }\n\n        this.componentRelay.saveItemWithPresave(note, () => {\n          note.content.text = this.note.content.text\n          note.content.preview_plain = this.note.content.text\n          note.content.preview_html = null\n        })\n      }\n    }\n}\n","export const base = {\n  fontFamily:\n        'var(--sn-stylekit-sans-serif-font)',\n  fontFamilyMono:\n        'var(--sn-stylekit-monospace-font)',\n  fontWeight: 400,\n  zIndex: 100,\n  link: 'var(--sn-stylekit-info-color)',\n  placeholder: 'var(--sn-stylekit-input-placeholder-color)',\n  textSecondary: '#4E5C6E',\n  textLight: 'var(--sn-stylekit-paragraph-text-color)',\n  textHighlight: '#ff0',\n  selected: 'var(--sn-stylekit-info-color)',\n  codeComment: 'var(--sn-stylekit-secondary-foreground-color)',\n  codePunctuation: 'var(--sn-stylekit-contrast-backround-color)',\n  codeNumber: '#d73a49',\n  codeProperty: '#c08b30',\n  codeTag: '#3d8fd1',\n  codeString: 'var(--sn-stylekit-success-color)',\n  codeSelector: '#6679cc',\n  codeAttr: '#c76b29',\n  codeEntity: '#22a2c9',\n  codeKeyword: 'var(--sn-stylekit-info-color)',\n  codeFunction: '#6f42c1',\n  codeStatement: '#22a2c9',\n  codePlaceholder: '#3d8fd1',\n  codeInserted: '#202746',\n  codeImportant: '#c94922',\n\n  blockToolbarBackground: 'var(--sn-stylekit-contrast-background-color)',\n  blockToolbarTrigger: 'var(--sn-stylekit-info-color)',\n  blockToolbarTriggerIcon: 'var(--sn-stylekit-paragraph-text-color)',\n  blockToolbarItem: 'var(--sn-stylekit-paragraph-text-color)',\n  blockToolbarText: 'var(--sn-stylekit-paragraph-text-color)',\n  blockToolbarHoverBackground: 'var(--sn-stylekit-neutral-contrast-color)',\n  blockToolbarDivider: 'var(--sn-stylekit-paragraph-text-color)',\n\n  noticeInfoBackground: 'var(--sn-stylekit-info-color)',\n  noticeInfoText: 'var(--sn-stylekit-info-contrast-color)',\n  noticeTipBackground: 'var(--sn-stylekit-success-color)',\n  noticeTipText: 'var(--sn-stylekit-success-contrast-color)',\n  noticeWarningBackground: 'var(--sn-stylekit-warning-color)',\n  noticeWarningText: 'var(--sn-stylekit-warning-contrast-color)'\n}\n\nexport const light = {\n  ...base,\n  background: 'transparent',\n  text: 'var(--sn-stylekit-paragraph-text-color)',\n  code: 'var(--sn-stylekit-secondary-foreground-color)',\n  cursor: 'var(--sn-stylekit-contrast-foreground-color)',\n  divider: 'var(--sn-stylekit--secondary-contrast-border-color)',\n\n  toolbarBackground: 'var(--sn-stylekit-secondary-background-color)',\n  toolbarInput: 'var(--sn-stylekit-secondary-background-color)',\n  toolbarItem: 'var(--sn-stylekit-paragraph-text-color)',\n\n  tableDivider: 'var(--sn-stylekit-secondary-foreground-color)',\n  tableSelected: 'var(--sn-stylekit-secondary-foreground-color)',\n  tableSelectedBackground: 'var(--sn-stylekit-contrast-background-color)',\n\n  quote: 'var(--sn-stylekit-secondary-foreground-color)',\n  codeBackground: 'var(--sn-stylekit-secondary-background-color)',\n  codeBorder: 'var(--sn-stylekit-secondary-foreground-color)',\n  horizontalRule: 'var(--sn-stylekit-input-placeholder-color)',\n  imageErrorBackground: 'var(--sn-stylekit-neutral-color)'\n}\n\nexport default light\n","// Modified SKAlert from StyleKit\n\nexport default class Alert {\n  /*\n        buttons: [{text, style, action}]\n        */\n  constructor ({ title, text, buttons }) {\n    this.title = title\n    this.text = text\n    this.buttons = buttons\n  }\n\n  buttonsString () {\n    const genButton = function (buttonDesc, index) {\n      if (buttonDesc.url) {\n        return `\n                <a href='${buttonDesc.url}' target=\"_blank\">\n              <div id='button-${index}' class='sk-button ${buttonDesc.style}'>\n                <div class='sk-label'>${buttonDesc.text}</div>\n              </div>\n                </a>\n            `\n      } else {\n        return `\n          <div id='button-${index}' class='sk-button ${buttonDesc.style}'>\n            <div class='sk-label'>${buttonDesc.text}</div>\n          </div>\n        `\n      }\n    }\n\n    const buttonString = this.buttons.map(function (buttonDesc, index) {\n      return genButton(buttonDesc, index)\n    }).join('')\n\n    const str = `\n        <div class='sk-button-group'>\n          ${buttonString}\n        </div>\n      `\n    return str\n  }\n\n  templateString () {\n    let buttonsTemplate\n    let panelStyle\n    if (this.buttons) {\n      buttonsTemplate = `\n          <div class=\"sk-panel-row\" style='margin-top: 8px;'>\n            ${this.buttonsString()}\n          </div>\n        `\n      panelStyle = ''\n    } else {\n      buttonsTemplate = ''\n      panelStyle = 'style=\"padding-bottom: 8px\"'\n    }\n    const titleTemplate = this.title ? `<div class='sk-h3 sk-panel-section-title'>${this.title}</div>` : ''\n    const messageTemplate = this.text ? `<p class='sk-p'>${this.text}</p>` : ''\n\n    const template = `\n        <div class=\"sk-modal\">\n          <div class=\"sk-modal-background\"></div>\n          <div class=\"sk-modal-content\">\n            <div class=\"sn-component\">\n              <div class=\"sk-panel\">\n                <div class=\"sk-panel-content\" ${panelStyle}>\n                  <div class=\"sk-panel-section\">\n                    ${titleTemplate}\n  \n                    <div class=\"sk-panel-row\">\n                      ${messageTemplate}\n                    </div>\n  \n                    ${buttonsTemplate}\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      `\n\n    return template\n  }\n\n  dismiss () {\n    this.onElement.removeChild(this.element)\n    document.removeEventListener('keyup', this.keyupListener)\n  }\n\n  primaryButton () {\n    let primary = this.buttons.find((button) => button.primary === true)\n    if (!primary) {\n      primary = this.buttons[this.buttons.length - 1]\n    }\n    return primary\n  }\n\n  keyupListener (event) {\n    if (event.key === 'Enter') {\n      const primaryButton = this.primaryButton()\n      primaryButton.action && primaryButton.action()\n      this.dismiss()\n    }\n  }\n\n  present (onElement = null) {\n    if (!onElement) { onElement = document.body }\n\n    this.onElement = onElement\n\n    this.element = document.createElement('div')\n    this.element.className = 'sn-component'\n    this.element.innerHTML = this.templateString().trim()\n\n    if (this.buttons) {\n      document.addEventListener('keyup', this.keyupListener)\n\n      this.buttons.forEach((buttonDesc, index) => {\n        const buttonElem = this.element.querySelector(`#button-${index}`)\n        buttonElem.onclick = () => {\n          buttonDesc.action && buttonDesc.action()\n          this.dismiss()\n        }\n      })\n    }\n\n    onElement.appendChild(this.element)\n  }\n}\n","import Alert from './Alert'\nimport Resizer from 'react-image-file-resizer'\n\nfunction linkify (inputText) {\n  // URLs starting with http://, https://\n  const replacePattern = /(\\b(^https?):\\/\\/[-A-Z0-9+&@#/%?=~_|!:,.;]*[-A-Z0-9+&@#/%=~_|])/gim\n  const replacedText = inputText.replace(replacePattern, '<$1>')\n\n  return replacedText\n}\n\nfunction getPlatform () {\n  const userAgent = navigator.userAgent.toLowerCase()\n\n  if (userAgent.indexOf(' electron/') > -1) {\n    return 'Desktop'\n  } else if (\n    (/(Version\\/\\d+.*\\/\\d+.0.0.0 Mobile|; ?wv|(iPhone|iPad|Macintosh).*AppleWebKit(?!.*Safari))/i\n      .test(navigator.userAgent))\n  ) {\n    if ((navigator.userAgent.indexOf('iP') > -1) || (navigator.userAgent.indexOf('Macintosh') > -1)) {\n      return 'iOS'\n    } else { return 'Android' }\n  } else {\n    return 'Browser'\n  }\n}\n\nconst platform = getPlatform()\n\nfunction openLinkDesktop (url) {\n  // more compatible way to open links\n  const invisibleA = document.createElement('a')\n\n  invisibleA.style.display = 'none'\n  invisibleA.href = url\n  invisibleA.target = '_blank'\n\n  document.body.appendChild(invisibleA)\n\n  invisibleA.click()\n  invisibleA.remove()\n}\n\nfunction openLinkMobile (url) {\n  let buttons\n  if (platform === 'iOS') {\n    buttons = [\n      {\n        text: 'CANCEL',\n        style: 'info',\n        action:\n                    function () { }\n      },\n      {\n        text: 'OPEN',\n        url: url,\n        style: 'info',\n        action:\n                    function () { }\n      }\n    ]\n  } else { // Android\n    buttons = [\n      {\n        text: 'CANCEL',\n        style: 'info',\n        action:\n                    function () { }\n      },\n      {\n        text: 'OPEN',\n        url: '',\n        style: 'info',\n        action:\n                    function () { window.open(url, '_blank') }\n      }\n    ]\n  }\n  const alert = new Alert({ title: 'Open Link', text: 'Do you want to open <u>' + url + '</u> ?', buttons })\n  alert.present()\n}\n\nconst resizeFile = (file) => new Promise(resolve => {\n  Resizer.imageFileResizer(file, 500, 500, 'JPEG', 10, 0,\n    uri => {\n      resolve(uri)\n    },\n    'base64'\n  )\n})\n\nexport { linkify, openLinkDesktop, openLinkMobile, resizeFile, platform }\n","import React from 'react'\nimport RichMarkdownEditor from 'rich-markdown-editor'\nimport { debounce } from 'lodash'\n\nimport BridgeManager from './lib/BridgeManager'\nimport theme from './lib/theme'\n// import youtube_embed from './embeds/YouTube';\n\nimport { linkify, openLinkDesktop, openLinkMobile, resizeFile, platform } from './lib/utils'\n\nexport default class LocalEditor extends React.Component {\n  constructor (props) {\n    super(props)\n    this.state = {}\n  }\n\n  componentDidMount () {\n    BridgeManager.get().addUpdateObserver(() => {\n      const note = BridgeManager.get().getNote()\n      const refresh = !this.state.note ||\n                (this.state.note && this.state.note.uuid !== note.uuid)\n      this.setState({\n        note: note\n      })\n      if (refresh) {\n        this.updateMarkdown()\n      }\n    })\n  }\n\n  updateMarkdown () {\n    let markdown = this.state.note.content.text\n    // onload replace links and fix newlines\n    markdown = linkify(markdown)\n      .replace(/(\\n{2})(\\n+)/g, (m, p, q) => p + q.replace(/(\\n)/g, '\\\\$1'))\n    if (markdown === '') {\n      markdown = '\\n'\n    }\n\n    this.setState({ markdown })\n  }\n\n    onChange = debounce((value) => {\n      if (this.state.note) {\n        const text = value()\n        const note = this.state.note\n        note.content.text = text\n        this.setState({ note: note })\n        BridgeManager.get().save()\n      }\n    })\n\n    render () {\n      return (\n        <div>\n          <RichMarkdownEditor\n            value={this.state.markdown}\n            placeholder=''\n            autoFocus\n            onChange={this.onChange.bind(this)}\n            theme={theme}\n            className='editor'\n            uploadImage={async file => {\n              return await resizeFile(file)\n            }}\n            onClickLink={(href, event) => {\n              // mobile RMe popup\n              if (!(platform === 'Desktop' || platform === 'Browser')) {\n                event.preventDefault()\n                openLinkMobile(href)\n              } else {\n                // desktop CTRL/CMD+click\n                if (event.ctrlKey || event.metaKey) {\n                  openLinkDesktop(href)\n                } else {\n                  // desktop RMe popup\n                  if (event._reactName === 'onClick') {\n                    openLinkDesktop(href)\n                  }\n                }\n              }\n            }}\n            onHoverLink={event => {\n              // mobile click on link\n              if (!(platform === 'Desktop' || platform === 'Browser')) {\n                event.preventDefault()\n                openLinkMobile(event.target.href)\n              }\n            }}\n            embeds={[\n              // youtube_embed,\n            ]}\n          />\n        </div>\n      )\n    }\n}\n","import './app.scss'\n\nimport React from 'react'\nimport LocalEditor from './LocalEditor'\n\nfunction App () {\n  return (\n    <div className='App'>\n      <LocalEditor />\n    </div>\n  )\n}\n\nexport default App\n","import './index.css'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n"],"sourceRoot":""}