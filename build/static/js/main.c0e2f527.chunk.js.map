{"version":3,"sources":["lib/BridgeManager.js","lib/theme.js","lib/Alert.js","lib/utils.js","LocalEditor.jsx","App.jsx","index.jsx"],"names":["BridgeManager","this","instance","constructor","updateObservers","initiateBridge","addUpdateObserver","callback","observer","push","notifyObserversOfUpdate","getNote","note","componentRelay","ComponentRelay","targetWindow","window","options","coallesedSavingDelay","onReady","document","documentElement","classList","add","platform","streamContextItem","save","content","text","replace","saveItemWithPresave","preview_plain","preview_html","light","fontFamily","fontFamilyMono","fontWeight","zIndex","link","placeholder","textSecondary","textLight","textHighlight","selected","codeComment","codePunctuation","codeNumber","codeProperty","codeTag","codeString","codeSelector","codeAttr","codeEntity","codeKeyword","codeFunction","codeStatement","codePlaceholder","codeInserted","codeImportant","blockToolbarBackground","blockToolbarTrigger","blockToolbarTriggerIcon","blockToolbarItem","blockToolbarText","blockToolbarHoverBackground","blockToolbarDivider","noticeInfoBackground","noticeInfoText","noticeTipBackground","noticeTipText","noticeWarningBackground","noticeWarningText","background","code","cursor","divider","toolbarBackground","toolbarInput","toolbarItem","tableDivider","tableSelected","tableSelectedBackground","quote","codeBackground","codeBorder","horizontalRule","imageErrorBackground","Alert","title","buttons","buttonsString","map","buttonDesc","index","url","style","genButton","join","templateString","buttonsTemplate","panelStyle","dismiss","onElement","removeChild","element","removeEventListener","keyupListener","primaryButton","primary","find","button","length","event","key","action","present","body","createElement","className","innerHTML","trim","addEventListener","forEach","querySelector","onclick","appendChild","navigator","userAgent","toLowerCase","indexOf","test","openLinkDesktop","invisibleA","display","href","target","click","remove","openLinkMobile","open","LocalEditor","props","gNote","setGNote","gNoteRef","useStateRef","gMarkdown","setGMarkdown","useState","setEditor","useEffect","get","refresh","current","uuid","updateMarkdown","markdown","m","p","q","onChange","debounce","value","ref","autoFocus","theme","onClickLink","preventDefault","ctrlKey","metaKey","_reactName","onHoverLink","handleDOMEvents","paste","embeds","App","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.c0e2f527.chunk.js","sourcesContent":["import ComponentRelay from \"@standardnotes/component-relay\";\n\nexport default class BridgeManager {\n  /* Singleton */\n  static instance = null;\n  static get() {\n    if (this.instance == null) {\n      this.instance = new BridgeManager();\n    }\n    return this.instance;\n  }\n\n  constructor() {\n    this.updateObservers = [];\n    this.initiateBridge();\n  }\n\n  addUpdateObserver(callback) {\n    const observer = { callback: callback };\n    this.updateObservers.push(observer);\n    return observer;\n  }\n\n  notifyObserversOfUpdate() {\n    for (const observer of this.updateObservers) {\n      observer.callback();\n    }\n  }\n\n  getNote() {\n    return this.note;\n  }\n\n  initiateBridge() {\n    this.componentRelay = new ComponentRelay({\n      targetWindow: window,\n      options: {\n        coallesedSavingDelay: 200,\n      },\n      onReady: () => {\n        // On ready and permissions authorization\n        document.documentElement.classList.add(this.componentRelay.platform);\n      },\n    });\n\n    this.componentRelay.streamContextItem((note) => {\n      this.note = note;\n\n      this.notifyObserversOfUpdate();\n    });\n  }\n\n  save() {\n    if (this.note) {\n      const note = this.note;\n\n      if (note.content && note.content.text) {\n        note.content.text = note.content.text.replace(/\\n\\\\/g, \"\\n\");\n      }\n\n      this.componentRelay.saveItemWithPresave(note, () => {\n        note.content.text = this.note.content.text;\n        note.content.preview_plain = this.note.content.text;\n        note.content.preview_html = null;\n      });\n    }\n  }\n}\n","export const base = {\n  fontFamily: \"var(--sn-stylekit-sans-serif-font)\",\n  fontFamilyMono: \"var(--sn-stylekit-monospace-font)\",\n  fontWeight: 400,\n  zIndex: 100,\n  link: \"var(--sn-stylekit-info-color)\",\n  placeholder: \"var(--sn-stylekit-input-placeholder-color)\",\n  textSecondary: \"#4E5C6E\",\n  textLight: \"var(--sn-stylekit-paragraph-text-color)\",\n  textHighlight: \"#ff0\",\n  selected: \"var(--sn-stylekit-info-color)\",\n  codeComment: \"var(--sn-stylekit-secondary-foreground-color)\",\n  codePunctuation: \"var(--sn-stylekit-contrast-backround-color)\",\n  codeNumber: \"#d73a49\",\n  codeProperty: \"#c08b30\",\n  codeTag: \"#3d8fd1\",\n  codeString: \"var(--sn-stylekit-success-color)\",\n  codeSelector: \"#6679cc\",\n  codeAttr: \"#c76b29\",\n  codeEntity: \"#22a2c9\",\n  codeKeyword: \"var(--sn-stylekit-info-color)\",\n  codeFunction: \"#6f42c1\",\n  codeStatement: \"#22a2c9\",\n  codePlaceholder: \"#3d8fd1\",\n  codeInserted: \"#202746\",\n  codeImportant: \"#c94922\",\n\n  blockToolbarBackground: \"var(--sn-stylekit-contrast-background-color)\",\n  blockToolbarTrigger: \"var(--sn-stylekit-info-color)\",\n  blockToolbarTriggerIcon: \"var(--sn-stylekit-paragraph-text-color)\",\n  blockToolbarItem: \"var(--sn-stylekit-paragraph-text-color)\",\n  blockToolbarText: \"var(--sn-stylekit-paragraph-text-color)\",\n  blockToolbarHoverBackground: \"var(--sn-stylekit-neutral-contrast-color)\",\n  blockToolbarDivider: \"var(--sn-stylekit-paragraph-text-color)\",\n\n  noticeInfoBackground: \"var(--sn-stylekit-info-color)\",\n  noticeInfoText: \"var(--sn-stylekit-info-contrast-color)\",\n  noticeTipBackground: \"var(--sn-stylekit-success-color)\",\n  noticeTipText: \"var(--sn-stylekit-success-contrast-color)\",\n  noticeWarningBackground: \"var(--sn-stylekit-warning-color)\",\n  noticeWarningText: \"var(--sn-stylekit-warning-contrast-color)\",\n};\n\nexport const light = {\n  ...base,\n  background: \"transparent\",\n  text: \"var(--sn-stylekit-paragraph-text-color)\",\n  code: \"var(--sn-stylekit-secondary-foreground-color)\",\n  cursor: \"var(--sn-stylekit-contrast-foreground-color)\",\n  divider: \"var(--sn-stylekit--secondary-contrast-border-color)\",\n\n  toolbarBackground: \"var(--sn-stylekit-secondary-background-color)\",\n  toolbarInput: \"var(--sn-stylekit-secondary-background-color)\",\n  toolbarItem: \"var(--sn-stylekit-paragraph-text-color)\",\n\n  tableDivider: \"var(--sn-stylekit-secondary-foreground-color)\",\n  tableSelected: \"var(--sn-stylekit-secondary-foreground-color)\",\n  tableSelectedBackground: \"var(--sn-stylekit-contrast-background-color)\",\n\n  quote: \"var(--sn-stylekit-secondary-foreground-color)\",\n  codeBackground: \"var(--sn-stylekit-secondary-background-color)\",\n  codeBorder: \"var(--sn-stylekit-secondary-foreground-color)\",\n  horizontalRule: \"var(--sn-stylekit-input-placeholder-color)\",\n  imageErrorBackground: \"var(--sn-stylekit-neutral-color)\",\n};\n\nexport default light;\n","// Modified SKAlert from StyleKit\n// TODO: migrate to React component\n\nexport default class Alert {\n  /*\n        buttons: [{text, style, action}]\n  */\n  constructor({ title, text, buttons }) {\n    this.title = title;\n    this.text = text;\n    this.buttons = buttons;\n  }\n\n  buttonsString() {\n    const genButton = function (buttonDesc, index) {\n      if (buttonDesc.url) {\n        return `\n                <a href='${buttonDesc.url}' target=\"_blank\">\n              <div id='button-${index}' class='sk-button ${buttonDesc.style}'>\n                <div class='sk-label'>${buttonDesc.text}</div>\n              </div>\n                </a>\n            `;\n      } else {\n        return `\n          <div id='button-${index}' class='sk-button ${buttonDesc.style}'>\n            <div class='sk-label'>${buttonDesc.text}</div>\n          </div>\n        `;\n      }\n    };\n\n    const buttonString = this.buttons\n      .map(function (buttonDesc, index) {\n        return genButton(buttonDesc, index);\n      })\n      .join(\"\");\n\n    const str = `\n        <div class='sk-button-group'>\n          ${buttonString}\n        </div>\n      `;\n    return str;\n  }\n\n  templateString() {\n    let buttonsTemplate;\n    let panelStyle;\n    if (this.buttons) {\n      buttonsTemplate = `\n          <div class=\"sk-panel-row\" style='margin-top: 8px;'>\n            ${this.buttonsString()}\n          </div>\n        `;\n      panelStyle = \"\";\n    } else {\n      buttonsTemplate = \"\";\n      panelStyle = 'style=\"padding-bottom: 8px\"';\n    }\n    const titleTemplate = this.title\n      ? `<div class='sk-h3 sk-panel-section-title'>${this.title}</div>`\n      : \"\";\n    const messageTemplate = this.text ? `<p class='sk-p'>${this.text}</p>` : \"\";\n\n    const template = `\n        <div class=\"sk-modal\">\n          <div class=\"sk-modal-background\"></div>\n          <div class=\"sk-modal-content\">\n            <div class=\"sn-component\">\n              <div class=\"sk-panel\">\n                <div class=\"sk-panel-content\" ${panelStyle}>\n                  <div class=\"sk-panel-section\">\n                    ${titleTemplate}\n  \n                    <div class=\"sk-panel-row\">\n                      ${messageTemplate}\n                    </div>\n  \n                    ${buttonsTemplate}\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      `;\n\n    return template;\n  }\n\n  dismiss() {\n    this.onElement.removeChild(this.element);\n    document.removeEventListener(\"keyup\", this.keyupListener);\n  }\n\n  primaryButton() {\n    let primary = this.buttons.find((button) => button.primary === true);\n    if (!primary) {\n      primary = this.buttons[this.buttons.length - 1];\n    }\n    return primary;\n  }\n\n  keyupListener(event) {\n    if (event.key === \"Enter\") {\n      const primaryButton = this.primaryButton();\n      primaryButton.action && primaryButton.action();\n      this.dismiss();\n    }\n  }\n\n  present(onElement = null) {\n    if (!onElement) {\n      onElement = document.body;\n    }\n\n    this.onElement = onElement;\n\n    this.element = document.createElement(\"div\");\n    this.element.className = \"sn-component\";\n    this.element.innerHTML = this.templateString().trim();\n\n    if (this.buttons) {\n      document.addEventListener(\"keyup\", this.keyupListener);\n\n      this.buttons.forEach((buttonDesc, index) => {\n        const buttonElem = this.element.querySelector(`#button-${index}`);\n        buttonElem.onclick = () => {\n          buttonDesc.action && buttonDesc.action();\n          this.dismiss();\n        };\n      });\n    }\n\n    onElement.appendChild(this.element);\n  }\n}\n","import Alert from \"./Alert\";\n\nfunction linkify(inputText) {\n  // URLs starting with http://, https://\n  const replacePattern =\n    /(\\b(^https?):\\/\\/[-A-Z0-9+&@#/%?=~_|!:,.;]*[-A-Z0-9+&@#/%=~_|])/gim;\n  const replacedText = inputText.replace(replacePattern, \"<$1>\");\n\n  return replacedText;\n}\n\nfunction getPlatform() {\n  const userAgent = navigator.userAgent.toLowerCase();\n\n  if (userAgent.indexOf(\" electron/\") > -1) {\n    return \"Desktop\";\n  } else if (\n    /(Version\\/\\d+.*\\/\\d+.0.0.0 Mobile|; ?wv|(iPhone|iPad|Macintosh).*AppleWebKit(?!.*Safari))/i.test(\n      navigator.userAgent\n    )\n  ) {\n    if (\n      navigator.userAgent.indexOf(\"iP\") > -1 ||\n      navigator.userAgent.indexOf(\"Macintosh\") > -1\n    ) {\n      return \"iOS\";\n    } else {\n      return \"Android\";\n    }\n  } else {\n    return \"Browser\";\n  }\n}\n\nconst platform = getPlatform();\n\nfunction openLinkDesktop(url) {\n  // more compatible way to open links\n  const invisibleA = document.createElement(\"a\");\n\n  invisibleA.style.display = \"none\";\n  invisibleA.href = url;\n  invisibleA.target = \"_blank\";\n\n  document.body.appendChild(invisibleA);\n\n  invisibleA.click();\n  invisibleA.remove();\n}\n\nfunction openLinkMobile(url) {\n  let buttons;\n  if (platform === \"iOS\") {\n    buttons = [\n      {\n        text: \"CANCEL\",\n        style: \"info\",\n        action: function () {},\n      },\n      {\n        text: \"OPEN\",\n        url: url,\n        style: \"info\",\n        action: function () {},\n      },\n    ];\n  } else {\n    // Android\n    buttons = [\n      {\n        text: \"CANCEL\",\n        style: \"info\",\n        action: function () {},\n      },\n      {\n        text: \"OPEN\",\n        url: \"\",\n        style: \"info\",\n        action: function () {\n          window.open(url, \"_blank\");\n        },\n      },\n    ];\n  }\n  const alert = new Alert({\n    title: \"Open Link\",\n    text: \"Do you want to open <u>\" + url + \"</u>?\",\n    buttons,\n  });\n  alert.present();\n}\n\nexport { linkify, openLinkDesktop, openLinkMobile, platform };\n","import { useState, useEffect } from \"react\";\nimport useStateRef from \"react-usestateref\";\n\nimport RichMarkdownEditor from \"rich-markdown-editor\";\nimport { debounce } from \"lodash\";\n\nimport BridgeManager from \"./lib/BridgeManager\";\nimport theme from \"./lib/theme\";\n// import youtube_embed from './embeds/YouTube';\n\nimport {\n  linkify,\n  openLinkDesktop,\n  openLinkMobile,\n  platform,\n} from \"./lib/utils\";\n\nexport default function LocalEditor(props) {\n  const [gNote, setGNote, gNoteRef] = useStateRef(null);\n  const [gMarkdown, setGMarkdown] = useState(\"\");\n\n  const [, setEditor] = useState(null);\n\n  useEffect(() => {\n    BridgeManager.get().addUpdateObserver(() => {\n      const note = BridgeManager.get().getNote();\n      const refresh =\n        !gNoteRef.current ||\n        (gNoteRef.current && gNoteRef.current.uuid !== note.uuid);\n      setGNote(note);\n      if (refresh) {\n        updateMarkdown(note);\n      }\n    });\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  const updateMarkdown = (note) => {\n    if (note) {\n      let markdown = note.content.text.replace(\n        /(\\n{2})(\\n+)(?!:::)(?!---)/g,\n        (m, p, q) => p + q.replace(/(\\n)/g, \"\\\\$1\")\n      );\n      // onload replace links and fix ghost bug\n      markdown = linkify(markdown);\n      if (markdown === \"\") {\n        markdown = \"\\n\";\n      }\n\n      setGMarkdown(markdown);\n    } else {\n      setGMarkdown(\"\");\n    }\n  };\n\n  const onChange = debounce((value) => {\n    if (gNote) {\n      const text = value();\n      const note = gNote;\n      note.content.text = text;\n      setGNote(note);\n      BridgeManager.get().save();\n    }\n  });\n\n  return (\n    <RichMarkdownEditor\n      value={gMarkdown}\n      ref={setEditor}\n      placeholder=\"\"\n      autoFocus\n      onChange={onChange}\n      theme={theme}\n      className=\"editor\"\n      onClickLink={(href, event) => {\n        // mobile RMe popup\n        if (!(platform === \"Desktop\" || platform === \"Browser\")) {\n          event.preventDefault();\n          openLinkMobile(href);\n        } else {\n          // desktop CTRL/CMD+click\n          if (event.ctrlKey || event.metaKey) {\n            openLinkDesktop(href);\n          } else {\n            // desktop RMe popup\n            if (event._reactName === \"onClick\") {\n              openLinkDesktop(href);\n            }\n          }\n        }\n      }}\n      onHoverLink={(event) => {\n        // mobile click on link\n        if (!(platform === \"Desktop\" || platform === \"Browser\")) {\n          event.preventDefault();\n          openLinkMobile(event.target.href);\n        }\n      }}\n      handleDOMEvents={{\n        paste: () => updateMarkdown(),\n      }}\n      embeds={\n        [\n          // youtube_embed,\n        ]\n      }\n    />\n  );\n}\n","import \"./app.scss\";\n\nimport React from \"react\";\nimport LocalEditor from \"./LocalEditor\";\n\nfunction App() {\n  return <div className=\"App\">{LocalEditor()}</div>;\n}\n\nexport default App;\n","import \"./index.css\";\n\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}